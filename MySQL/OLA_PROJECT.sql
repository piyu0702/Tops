create database ola2;

use ola2;

create table DRIVERS
(
D_ID INT PRIMARY KEY,
D_NAME VARCHAR(50),
PHONE VARCHAR(15),
LICENSE_NUMBER VARCHAR(20),
VEHICLE_TYPE  ENUM('Mini', 'Prime','Bike', 'Auto'), 
VEHICLE_NUMBER VARCHAR(30) UNIQUE
);

INSERT INTO drivers (D_ID, D_NAME, PHONE, LICENSE_NUMBER, VEHICLE_TYPE, VEHICLE_NUMBER) VALUES
(1, 'AA', '1234567891', 'GJ01 2022 1234567', 'Mini', 'GJ 01 AB 1234'),
(2, 'BB', '2345678952', 'MH02 2022 2345678', 'Prime', 'MH 02 DC 7891'),
(3, 'CC', '3654789651', 'RJ05 2020 5412368', 'Prime', 'RJ 20 FG 4557'),
(4, 'DD', '3654785120', 'DL07 2018 3654789', 'Bike', 'DL 15 YZ 5678'),
(5, 'EE', '9857456300', 'MP 09 2014 2598746', 'Auto', 'MP 24 WD 6789'),
(6, 'FF', '6584100025', 'RJ08 2010 4577662', 'Auto', 'RJ 10 NG 6587'),
(7, 'GG', '1528756922', 'DL15 2015 3622789', 'Mini', 'DL 20 CZ 5698'),
(8, 'HH', '5289746364', 'MP 19 2024 3238746', 'Mini', 'MP 18 XY 9879'),
(9, 'II', '8521479630', 'MH18 2021 2345548', 'Prime', 'MH 22 KG 8991'),
(10, 'JJ', '3698521470', 'GJ27 2019 1223367', 'Bike', 'GJ 01 AB 5698');


CREATE TABLE PASSENGERS
(
P_ID INT PRIMARY KEY ,
P_NAME VARCHAR(50),
PHONE VARCHAR(15),
EMAIL VARCHAR(50),
GENDER ENUM('MALE','FEMALE','OTHER'),
VEHICLE_NUMBER VARCHAR(20),
FOREIGN KEY ( VEHICLE_NUMBER) REFERENCES DRIVERS ( VEHICLE_NUMBER)
);


INSERT INTO passengers (P_ID, P_NAME, PHONE, EMAIL, GENDER, VEHICLE_NUMBER) VALUES
(1, 'PP', '1254879630', 'pp@1.com', 'MALE', 'MH 02 DC 7891'),
(2, 'QQ', '2543698745', 'qq@6.com', 'FEMALE', 'GJ 01 AB 1234'),
(3, 'RR', '2014587963', 'rr@7.com', 'FEMALE', 'MP 24 WD 6789'),
(4, 'SS', '3698547120', 'ss@8.com', 'MALE', 'RJ 10 NG 6587'),
(5, 'UU', '6985231470', 'uu@2.com', 'MALE', 'RJ 20 FG 4557'),
(6, 'VV', '2501478963', 'vv@5.com', 'MALE', 'MH 22 KG 8991'),
(7, 'WW', '3654782098', 'ww@9.com', 'FEMALE', 'DL 15 YZ 5678'),
(8, 'XX', '8521463790', 'xx@4.com', 'MALE', 'GJ 01 AB 5698'),
(9, 'YY', '7456321089', 'yy@1.com', 'FEMALE', 'MP 18 XY 9879'),
(10, 'ZZ', '2520369720', 'zz@2.com', 'FEMALE', 'DL 20 CZ 5698');



SELECT * FROM DRIVERS INNER JOIN PASSENGERS ON DRIVERS.VEHICLE_NUMBER = PASSENGERS.VEHICLE_NUMBER;


CREATE TABLE NEW_PASSENGERS
(
P_ID INT  PRIMARY KEY ,
P_NAME VARCHAR(50),
PHONE VARCHAR(15),
EMAIL VARCHAR(50),
GENDER ENUM('MALE','FEMALE','OTHER'),
VEHICLE_NUMBER VARCHAR(20),
FOREIGN KEY ( VEHICLE_NUMBER) REFERENCES DRIVERS ( VEHICLE_NUMBER)
);
 
   
   DELIMITER $$

CREATE TRIGGER AF_INS_PASSENGERS
AFTER INSERT ON PASSENGERS
FOR EACH ROW
BEGIN
    INSERT INTO NEW_PASSENGERS 
    (P_ID, P_NAME, PHONE, EMAIL, GENDER, VEHICLE_NUMBER)
    VALUES (NEW.P_ID, NEW.P_NAME, NEW.PHONE, NEW.EMAIL, NEW.GENDER, NEW.VEHICLE_NUMBER);
END$$

DELIMITER ;

INSERT INTO passengers (P_ID, P_NAME, PHONE, EMAIL, GENDER, VEHICLE_NUMBER) VALUES
(11, 'KK', '2541398240', 'kk@7.com', 'FEMALE', 'GJ 01 AB 1234');